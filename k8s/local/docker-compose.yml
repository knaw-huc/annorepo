version: '2'

services:
  annorepo_server:
    container_name: annorepo_server
    environment:
      - AR_EXTERNAL_BASE_URL=http://localhost:2021
      - AR_MONGODB_URL=mongodb://annorepo_mongodb/
      - AR_DB_NAME=annorepo
      - AR_PAGE_SIZE=100
      - AR_ROOT_API_KEY=root
    expose:
      - 2021
      - 9999
    ports:
      - "2021:8080"
      - "9999:8081"
    image: annorepo:0.8.0
    networks:
      - annorepo_network
    restart: unless-stopped
    tty: true
    depends_on:
      - annorepo_mongodb

  annorepo_mongodb:
    container_name: annorepo_mongodb
    expose:
      - 27017
    image: mongo:6.0.23
    networks:
      - annorepo_network
    restart: unless-stopped
    tty: true
    volumes:
      - annorepo_mongodb_data:/data/db:rw

networks:
  annorepo_network:

volumes:
  annorepo_mongodb_data:
    driver: local